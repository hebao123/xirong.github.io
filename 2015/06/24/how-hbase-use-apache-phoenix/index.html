<!doctype html>



  


<html class="theme-next mist use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />









  <meta name="360-site-verification" content="2ebfa6bfe0988ac65c00405e3012ab01" />




  
  
  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="phoenix,hbase,sql" />





  <link rel="alternate" href="/atom.xml" title="自由" type="application/atom+xml" />









<meta name="description" content="hbase 提供很方便的shell脚本，可以对数据表进行 CURD 操作，但是毕竟是有一定的学习成本的，基本上对于开发来讲，sql 语句都是看家本领，那么，有没有一种方法可以把 sql 语句转换成 hbase的原生API呢？ 这样就可以通过普通平常的 sql 来对hbase 进行数据的管理，使用成本大大降低。Apache Phoenix 组件就完成了这种需求，官方注解为 “Phoenix - we">
<meta property="og:type" content="article">
<meta property="og:title" content="使用Phoenix通过sql语句更新操作hbase数据">
<meta property="og:url" content="http://www.ixirong.com/2015/06/24/how-hbase-use-apache-phoenix/index.html">
<meta property="og:site_name" content="自由">
<meta property="og:description" content="hbase 提供很方便的shell脚本，可以对数据表进行 CURD 操作，但是毕竟是有一定的学习成本的，基本上对于开发来讲，sql 语句都是看家本领，那么，有没有一种方法可以把 sql 语句转换成 hbase的原生API呢？ 这样就可以通过普通平常的 sql 来对hbase 进行数据的管理，使用成本大大降低。Apache Phoenix 组件就完成了这种需求，官方注解为 “Phoenix - we">
<meta property="og:image" content="https://phoenix.apache.org/images/squirrel.png">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="使用Phoenix通过sql语句更新操作hbase数据">
<meta name="twitter:description" content="hbase 提供很方便的shell脚本，可以对数据表进行 CURD 操作，但是毕竟是有一定的学习成本的，基本上对于开发来讲，sql 语句都是看家本领，那么，有没有一种方法可以把 sql 语句转换成 hbase的原生API呢？ 这样就可以通过普通平常的 sql 来对hbase 进行数据的管理，使用成本大大降低。Apache Phoenix 组件就完成了这种需求，官方注解为 “Phoenix - we">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Mist',
    sidebar: {"position":"left","display":"hide"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: 'xirong'
    }
  };
</script>

  <title> 使用Phoenix通过sql语句更新操作hbase数据 | 自由 </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  










  
  
    
  

  <div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">自由</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle"></p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-commonweal">
          <a href="/404.html" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-heartbeat"></i> <br />
            
            公益404
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="#" class="st-search-show-outputs">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <form class="site-search-form">
  <input type="text" id="st-search-input" class="st-search-input st-default-search-input" />
</form>

<script type="text/javascript">
  (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
    (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
    e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
  })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

  _st('install', 'CMcqT-2yt1yatw_zFhNC','2.0.0');
</script>



    </div>
  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                使用Phoenix通过sql语句更新操作hbase数据
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2015-06-24T18:47:17+08:00" content="2015-06-24">
              2015-06-24
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/大数据/" itemprop="url" rel="index">
                    <span itemprop="name">大数据</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2015/06/24/how-hbase-use-apache-phoenix/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2015/06/24/how-hbase-use-apache-phoenix/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          
             <span id="/2015/06/24/how-hbase-use-apache-phoenix/" class="leancloud_visitors" data-flag-title="使用Phoenix通过sql语句更新操作hbase数据">
               &nbsp; | &nbsp;
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>hbase &#x63D0;&#x4F9B;&#x5F88;&#x65B9;&#x4FBF;&#x7684;shell&#x811A;&#x672C;&#xFF0C;&#x53EF;&#x4EE5;&#x5BF9;&#x6570;&#x636E;&#x8868;&#x8FDB;&#x884C; CURD &#x64CD;&#x4F5C;&#xFF0C;&#x4F46;&#x662F;&#x6BD5;&#x7ADF;&#x662F;&#x6709;&#x4E00;&#x5B9A;&#x7684;&#x5B66;&#x4E60;&#x6210;&#x672C;&#x7684;&#xFF0C;&#x57FA;&#x672C;&#x4E0A;&#x5BF9;&#x4E8E;&#x5F00;&#x53D1;&#x6765;&#x8BB2;&#xFF0C;sql &#x8BED;&#x53E5;&#x90FD;&#x662F;&#x770B;&#x5BB6;&#x672C;&#x9886;&#xFF0C;&#x90A3;&#x4E48;&#xFF0C;&#x6709;&#x6CA1;&#x6709;&#x4E00;&#x79CD;&#x65B9;&#x6CD5;&#x53EF;&#x4EE5;&#x628A; sql &#x8BED;&#x53E5;&#x8F6C;&#x6362;&#x6210; hbase&#x7684;&#x539F;&#x751F;API&#x5462;&#xFF1F; &#x8FD9;&#x6837;&#x5C31;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x666E;&#x901A;&#x5E73;&#x5E38;&#x7684; sql &#x6765;&#x5BF9;hbase &#x8FDB;&#x884C;&#x6570;&#x636E;&#x7684;&#x7BA1;&#x7406;&#xFF0C;&#x4F7F;&#x7528;&#x6210;&#x672C;&#x5927;&#x5927;&#x964D;&#x4F4E;&#x3002;Apache Phoenix &#x7EC4;&#x4EF6;&#x5C31;&#x5B8C;&#x6210;&#x4E86;&#x8FD9;&#x79CD;&#x9700;&#x6C42;&#xFF0C;&#x5B98;&#x65B9;&#x6CE8;&#x89E3;&#x4E3A; &#x201C;Phoenix - we put the SQL back in NoSql&#x201D;&#xFF0C;&#x901A;&#x8FC7;&#x5B98;&#x65B9;&#x8BF4;&#x660E;&#xFF0C;Phoenix &#x7684;&#x6027;&#x80FD;&#x5F88;&#x9AD8;&#xFF0C;&#x76F8;&#x5BF9;&#x4E8E; hbase &#x539F;&#x751F;&#x7684;scan &#x5E76;&#x4E0D;&#x4F1A;&#x5DEE;&#x591A;&#x5C11;&#xFF0C;&#x800C;&#x5BF9;&#x4E8E;&#x7C7B;&#x4F3C;&#x7684;&#x7EC4;&#x4EF6; hive&#x3001;Impala&#x7B49;&#xFF0C;&#x6027;&#x80FD;&#x6709;&#x7740;&#x663E;&#x8457;&#x7684;&#x63D0;&#x5347;&#xFF0C;&#x8BE6;&#x7EC6;&#x8BF7;&#x9605;&#x8BFB; <a href="https://phoenix.apache.org/performance.html&#x3002;" target="_blank" rel="external">https://phoenix.apache.org/performance.html&#x3002;</a></p>
<p>Apache Phoenix &#x5B98;&#x65B9;&#x7AD9;&#x70B9;&#xFF1A;<a href="https://phoenix.apache.org/" target="_blank" rel="external">https://phoenix.apache.org/</a><br>Phoenix&#x652F;&#x6301;&#x7684;sql&#x8BED;&#x53E5;&#xFF1A; <a href="https://phoenix.apache.org/language/index.html" target="_blank" rel="external">https://phoenix.apache.org/language/index.html</a><br>Phoenix &#x652F;&#x6301;&#x7684;DataTypes&#xFF1A;<a href="https://phoenix.apache.org/language/datatypes.html" target="_blank" rel="external">https://phoenix.apache.org/language/datatypes.html</a><br>Phoenix &#x652F;&#x6301;&#x7684;&#x51FD;&#x6570;&#xFF1A;<a href="https://phoenix.apache.org/language/functions.html" target="_blank" rel="external">https://phoenix.apache.org/language/functions.html</a></p>
<a id="more"></a>
<h1 id="&#x4E00;&#x5B89;&#x88C5;&#x4F7F;&#x7528;">&#x4E00;&#x3001;&#x5B89;&#x88C5;&#x4F7F;&#x7528;</h1><p>Phoenix &#x5B89;&#x88C5;&#x5F88;&#x7B80;&#x5355;&#xFF0C;&#x4E0B;&#x8F7D;&#x5BF9;&#x5E94;hbase&#x7248;&#x672C;&#x7684;Phoenix&#xFF0C;<a href="https://phoenix.apache.org/download.html" target="_blank" rel="external">&#x4E0B;&#x8F7D;&#x5730;&#x5740;</a>&#xFF0C;&#x4EE5;<code>phoenix-4.4.0-HBase-0.98-bin.tar.gz</code>&#x4E3A;&#x4F8B;&#xFF0C;&#x89E3;&#x538B;&#x6587;&#x4EF6;&#xFF0C;&#x5C06;<code>phoenix-4.4.0-server.jar</code> &#x62F7;&#x8D1D;&#x5230;hbase&#x5B89;&#x88C5;&#x76EE;&#x5F55;&#x7684;lib&#x4E0B;&#xFF0C;&#x6CE8;&#x610F;&#xFF1A;&#x6BCF;&#x53F0;regionserver&#x5747;&#x9700;&#x8981;&#x62F7;&#x8D1D;&#xFF0C;&#x91CD;&#x542F;hbase server&#x5373;&#x53EF;&#xFF0C;&#x5B98;&#x65B9;&#x5982;&#x4E0B;&#xFF1A;</p>
<blockquote>
<ul>
<li><a href="https://phoenix.apache.org/download.html" target="_blank" rel="external">download</a> and expand the latest phoenix-[version]-bin.tar.</li>
<li>Add the phoenix-[version]-server.jar to the classpath of all HBase region server and master and remove any previous version. An easy way to do this is to copy it into the HBase lib directory (use phoenix-core-[version].jar for Phoenix 3.x)</li>
<li>restart the region servers</li>
<li>Add the phoenix-[version]-client.jar to the classpath of any Phoenix client.</li>
<li>download and setup <a href="https://phoenix.apache.org/installation.html#SQL_Client" target="_blank" rel="external">SQuirrel</a> as your SQL client so you can issue adhoc SQL against your HBase cluster</li>
</ul>
</blockquote>
<p>&#x8BE6;&#x60C5;&#x67E5;&#x770B;&#xFF1A;<a href="https://phoenix.apache.org/Phoenix-in-15-minutes-or-less.html" target="_blank" rel="external">Phoenix-in-15-minutes</a> &#x3002;</p>
<h1 id="&#x4E8C;shell-&#x547D;&#x4EE4;">&#x4E8C;&#x3001;shell &#x547D;&#x4EE4;</h1><p>&#x901A;&#x8FC7;&#x6848;&#x4F8B;&#xFF0C;create &#x8868;&#xFF0C;&#x63D2;&#x5165;&#x8BED;&#x53E5;&#xFF0C;&#x66F4;&#x65B0;&#x8BED;&#x53E5;&#xFF0C;&#x5220;&#x9664;&#x8BED;&#x53E5;&#x6848;&#x4F8B;&#xFF0C;&#x8BE6;&#x7EC6;&#x53EF;&#x53C2;&#x8003;&#xFF1A;<a href="https://phoenix.apache.org/faq.html" target="_blank" rel="external">https://phoenix.apache.org/faq.html</a> </p>
<p>Phoenix &#x8FDE;&#x63A5;hbase&#x7684;&#x547D;&#x4EE4;&#x5982;&#x4E0B;&#xFF0C;<code>sqlline.py [zookeeper]</code> &#xFF1A;</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">[hadoop@slave2 lib]$ ./sqlline.py <span class="number">10.35</span>.<span class="number">66.72</span></span><br><span class="line">Setting property: [isolation, TRANSACTION_READ_COMMITTED]</span><br><span class="line">issuing: !connect jdbc:phoenix:<span class="number">10.35</span>.<span class="number">66.72</span> none none org.apache.phoenix.jdbc.PhoenixDriver</span><br><span class="line">Connecting to jdbc:phoenix:<span class="number">10.35</span>.<span class="number">66.72</span></span><br><span class="line"><span class="number">15</span>/<span class="number">06</span>/<span class="number">24</span> <span class="number">13</span>:<span class="number">06</span>:<span class="number">29</span> WARN util.NativeCodeLoader: Unable to load native-hadoop library <span class="keyword">for</span> your platform... using <span class="built_in">builtin</span>-java classes <span class="built_in">where</span> applicable</span><br><span class="line">Connected to: Phoenix (version <span class="number">4.2</span>)</span><br><span class="line">Driver: PhoenixEmbeddedDriver (version <span class="number">4.2</span>)</span><br><span class="line">Autocommit status: <span class="literal">true</span></span><br><span class="line">Transaction isolation: TRANSACTION_READ_COMMITTED</span><br><span class="line">Building list of tables and columns <span class="keyword">for</span> tab-completion (<span class="built_in">set</span> fastconnect to <span class="literal">true</span> to skip)...</span><br><span class="line"><span class="number">193</span>/<span class="number">193</span> (<span class="number">100</span>%) Done</span><br><span class="line">Done</span><br><span class="line">sqlline version <span class="number">1.1</span>.<span class="number">2</span></span><br><span class="line"><span class="number">0</span>: jdbc:phoenix:<span class="number">10.35</span>.<span class="number">66.72</span>&gt;!tables</span><br><span class="line">+------------------------------------------+------------------------------------------+------------------------------------------+-------------------+</span><br><span class="line">|                TABLE_CAT                 |               TABLE_SCHEM                |                TABLE_NAME                |                TA |</span><br><span class="line">+------------------------------------------+------------------------------------------+------------------------------------------+-------------------+</span><br><span class="line">| null                                     | WL                                       | BIG_LOG_DEVUTRACEID_INDEX                | INDEX             |</span><br><span class="line">| null                                     | WL                                       | MSGCENTER_PUSHMESSAGE_V2_OWNERPAGE_INDEX | INDEX             |</span><br><span class="line">| null                                     | SYSTEM                                   | CATALOG                                  | SYSTEM TABLE      |</span><br><span class="line">| null                                     | SYSTEM                                   | SEQUENCE                                 | SYSTEM TABLE      |</span><br><span class="line">| null                                     | SYSTEM                                   | STATS                                    | SYSTEM TABLE      |</span><br><span class="line">| null                                     | DMO                                      | SOWNTOWN_STATICS                         | TABLE             |</span><br><span class="line">| null                                     | OL                                       | BIGLOG                                   | TABLE             |</span><br><span class="line">| null                                     | WL                                       | BIG_LOG                                  | TABLE             |</span><br><span class="line">| null                                     | WL                                       | ERROR_LOG                                | TABLE             |</span><br><span class="line">| null                                     | WL                                       | MSGCENTER_PUSHMESSAGE                    | TABLE             |</span><br><span class="line">| null                                     | WL                                       | MSGCENTER_PUSHMESSAGE_V2                 | TABLE             |</span><br><span class="line">+------------------------------------------+------------------------------------------+------------------------------------------+------------------</span><br></pre></td></tr></table></figure>
<p>&#x4ECE;&#x4E0A;&#x9762;&#x80FD;&#x591F;&#x770B;&#x5230;&#xFF0C;&#x5DF2;&#x7ECF;&#x8FDE;&#x63A5;&#x5230;&#x4E86;hbase&#x96C6;&#x7FA4;&#x4E0A;&#x9762;&#xFF0C;<code>Phoenix version 4.2</code> &#xFF0C;<code>sqlline version 4.2</code>  &#xFF0C;&#x8F93;&#x5165;Phoenix&#x652F;&#x6301;&#x7684;&#x547D;&#x4EE4;<code>&#xFF01;tables</code>&#x53EF;&#x4EE5;&#x67E5;&#x770B;&#x5F53;&#x524D;&#x96C6;&#x7FA4;&#x4E2D;&#x5B58;&#x5728;&#x7684;&#x6570;&#x636E;&#x8868;&#xFF0C;&#x80FD;&#x591F;&#x770B;&#x5230;&#x6709;&#x4E9B;&#x662F; <code>SYSTEM TABLE</code>&#xFF0C;&#x5176;&#x5B83;&#x7684;&#x90FD;&#x662F;&#x81EA;&#x5DF1;&#x5EFA;&#x7ACB;&#x7684;&#xFF1B;</p>
<p>&#x4E0B;&#x9762;&#x901A;&#x8FC7;&#x811A;&#x672C;&#x6765;&#x6A21;&#x62DF;&#x4E0B;&#x4F7F;&#x7528;Phoenix&#x5EFA;&#x7ACB;&#x6570;&#x636E;&#x8868;&#x3001;&#x4FEE;&#x6539;&#x8868;&#x3001;&#x6DFB;&#x52A0;&#x6570;&#x636E;&#x3001;&#x4FEE;&#x6539;&#x6570;&#x636E;&#x3001;&#x5220;&#x9664;&#x6570;&#x636E;&#x3001;&#x5220;&#x9664;&#x8868;&#x7B49;&#x64CD;&#x4F5C;&#xFF1A;</p>
<p>1&#x3001;&#x65B0;&#x5EFA;&#x4E00;&#x5F20;<code>Person</code>&#x8868;&#xFF0C;&#x542B;&#x6709;<code>IDCardNum</code>&#xFF0C;<code>Name</code>&#xFF0C;<code>Age</code> &#x4E09;&#x4E2A;&#x5B57;&#x6BB5; &#xFF0C;<code>test</code> &#x4E3A;<code>table_schem</code> &#xFF0C;&#x6807;&#x51C6;sql&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator"><span class="keyword">create</span> <span class="keyword">table</span> <span class="keyword">IF</span> <span class="keyword">NOT</span> <span class="keyword">EXISTS</span> test.Person (IDCardNum <span class="built_in">INTEGER</span> <span class="keyword">not</span> <span class="literal">null</span> <span class="keyword">primary</span> <span class="keyword">key</span>, Name <span class="built_in">varchar</span>(<span class="number">20</span>),Age <span class="built_in">INTEGER</span>);</span></span><br></pre></td></tr></table></figure>
<p>&#x5728; Phoenix &#x4E2D;&#x4F7F;&#x7528;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span>: jdbc:phoenix:<span class="number">10.35</span>.<span class="number">66.72</span>&gt; create table IF NOT EXISTS test.Person (IDCardNum INTEGER not null primary key, Name varchar(<span class="number">20</span>),Age INTEGER);</span><br><span class="line">No rows affected (<span class="number">0.344</span> seconds)</span><br><span class="line"><span class="number">0</span>: jdbc:phoenix:<span class="number">10.35</span>.<span class="number">66.72</span>&gt; !tables</span><br><span class="line">+------------------------------------------+------------------------------------------+------------------------------------------+-------------------+</span><br><span class="line">|                TABLE_CAT                 |               TABLE_SCHEM                |                TABLE_NAME                |                TA |</span><br><span class="line">+------------------------------------------+------------------------------------------+------------------------------------------+-------------------+</span><br><span class="line">| null                                     | WL                                       | BIG_LOG_DEVUTRACEID_INDEX                | INDEX             |</span><br><span class="line">| null                                     | WL                                       | MSGCENTER_PUSHMESSAGE_V2_OWNERPAGE_INDEX | INDEX             |</span><br><span class="line">| null                                     | SYSTEM                                   | CATALOG                                  | SYSTEM TABLE      |</span><br><span class="line">| null                                     | SYSTEM                                   | SEQUENCE                                 | SYSTEM TABLE      |</span><br><span class="line">| null                                     | SYSTEM                                   | STATS                                    | SYSTEM TABLE      |</span><br><span class="line">| null                                     | DMO                                      | SOWNTOWN_STATICS                         | TABLE             |</span><br><span class="line">| null                                     | OL                                       | BIGLOG                                   | TABLE             |</span><br><span class="line">| null                                     | TEST                                     | PERSON                                  | TABLE             |</span><br><span class="line">| null                                     | WL                                       | BIG_LOG                                  | TABLE             |</span><br><span class="line">| null                                     | WL                                       | ERROR_LOG                                | TABLE             |</span><br><span class="line">| null                                     | WL                                       | MSGCENTER_PUSHMESSAGE                    | TABLE             |</span><br><span class="line">| null                                     | WL                                       | MSGCENTER_PUSHMESSAGE_V2                 | TABLE             |</span><br><span class="line">+------------------------------------------+------------------------------------------+------------------------------------------+-------------------+</span><br><span class="line"><span class="number">0</span>: jdbc:phoenix:<span class="number">10.35</span>.<span class="number">66.72</span>&gt; select * from TEST.PERSON;</span><br><span class="line">+------------------------------------------+----------------------+------------------------------------------+</span><br><span class="line">|                IDCARDNUM                 |         NAME         |                   AGE                    |</span><br><span class="line">+------------------------------------------+----------------------+------------------------------------------+</span><br><span class="line">+------------------------------------------+----------------------+------------------------------------------+</span><br></pre></td></tr></table></figure>
<p>&#x53EF;&#x4EE5;&#x770B;&#x5230;&#xFF0C;hbase&#x4E2D;&#x5DF2;&#x7ECF;&#x5B58;&#x5728;&#x6570;&#x636E;&#x8868; <code>Person</code>&#x4E86;&#xFF0C;&#x5305;&#x542B;&#x4E86;&#x4E09;&#x5217;&#x3002;</p>
<p>2&#x3001;&#x5BF9;&#x8868;&#x8FDB;&#x884C;&#x63D2;&#x5165;&#x64CD;&#x4F5C;&#xFF0C;sql&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator"><span class="keyword">insert</span> <span class="keyword">into</span> Person (IDCardNum,Name,Age) <span class="keyword">values</span> (<span class="number">100</span>,<span class="string">&apos;&#x5C0F;&#x660E;&apos;</span>,<span class="number">12</span>);</span></span><br><span class="line"><span class="operator"><span class="keyword">insert</span> <span class="keyword">into</span> Person (IDCardNum,Name,Age) <span class="keyword">values</span> (<span class="number">101</span>,<span class="string">&apos;&#x5C0F;&#x7EA2;&apos;</span>,<span class="number">15</span>);</span></span><br><span class="line"><span class="operator"><span class="keyword">insert</span> <span class="keyword">into</span> Person (IDCardNum,Name,Age) <span class="keyword">values</span> (<span class="number">103</span>,<span class="string">&apos;&#x5C0F;&#x738B;&apos;</span>,<span class="number">22</span>);</span></span><br></pre></td></tr></table></figure>
<p>&#x5728; Phoenix &#x4E2D;&#x63D2;&#x5165;&#x7684;&#x8BED;&#x53E5;&#x4E3A; <code>upsert</code> &#xFF0C;&#x5177;&#x4F53;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span>: jdbc:phoenix:<span class="number">10.35</span>.<span class="number">66.72</span>&gt; upsert into test.Person (IDCardNum,Name,Age) values (<span class="number">100</span>,<span class="string">&apos;&#x5C0F;&#x660E;&apos;</span>,<span class="number">12</span>);</span><br><span class="line"><span class="number">1</span> row affected (<span class="number">0.043</span> seconds)</span><br><span class="line"><span class="number">0</span>: jdbc:phoenix:<span class="number">10.35</span>.<span class="number">66.72</span>&gt; upsert into test.Person (IDCardNum,Name,Age) values (<span class="number">101</span>,<span class="string">&apos;&#x5C0F;&#x7EA2;&apos;</span>,<span class="number">15</span>);</span><br><span class="line"><span class="number">1</span> row affected (<span class="number">0.018</span> seconds)</span><br><span class="line"><span class="number">0</span>: jdbc:phoenix:<span class="number">10.35</span>.<span class="number">66.72</span>&gt; upsert into test.Person (IDCardNum,Name,Age) values (<span class="number">103</span>,<span class="string">&apos;&#x5C0F;&#x738B;&apos;</span>,<span class="number">22</span>);</span><br><span class="line"><span class="number">1</span> row affected (<span class="number">0.009</span> seconds)</span><br><span class="line"><span class="number">0</span>: jdbc:phoenix:<span class="number">10.35</span>.<span class="number">66.72</span>&gt; select * from test.Person;</span><br><span class="line">+------------------------------------------+----------------------+------------------------------------------+</span><br><span class="line">|                IDCARDNUM                 |         NAME         |                   AGE                    |</span><br><span class="line">+------------------------------------------+----------------------+------------------------------------------+</span><br><span class="line">| <span class="number">100</span>                                      | &#x5C0F;&#x660E;                   | <span class="number">12</span>                                       |</span><br><span class="line">| <span class="number">101</span>                                      | &#x5C0F;&#x7EA2;                   | <span class="number">15</span>                                       |</span><br><span class="line">| <span class="number">103</span>                                      | &#x5C0F;&#x738B;                   | <span class="number">22</span>                                       |</span><br><span class="line">+------------------------------------------+----------------------+------------------------------------------+</span><br><span class="line"><span class="number">3</span> rows selected (<span class="number">0.115</span> seconds)</span><br></pre></td></tr></table></figure>
<p>&#x4ECE;&#x4E0A;&#x9762;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#xFF0C;&#x4E09;&#x6761;&#x6570;&#x636E;&#x5DF2;&#x7ECF;&#x8FDB;&#x5165;hbase&#x91CC;&#x9762;&#x4E86;&#xFF1B;&#x597D;&#x4E86;&#xFF0C;&#x73B0;&#x5728;&#x8981;&#x5BF9;&#x8868;&#x6DFB;&#x52A0;&#x4E00;&#x5217; <code>sex</code> &#x6027;&#x522B;&#x64CD;&#x4F5C;&#xFF0C;&#x600E;&#x4E48;&#x529E;&#xFF1F;</p>
<p>3&#x3001;alter &#x4FEE;&#x6539;&#x8868;&#x6570;&#x636E;&#xFF0C;sql&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> test.Persion <span class="keyword">ADD</span> sex <span class="built_in">varchar</span>(<span class="number">10</span>);</span></span><br></pre></td></tr></table></figure>
<p>Phoenix &#x4E2D;&#x64CD;&#x4F5C;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span>: jdbc:phoenix:<span class="number">10.35</span>.<span class="number">66.72</span>&gt; ALTER TABLE test.Person ADD sex varchar(<span class="number">10</span>);</span><br><span class="line">No rows affected (<span class="number">0.191</span> seconds)</span><br><span class="line">: jdbc:phoenix:<span class="number">10.35</span>.<span class="number">66.72</span>&gt; select * from test.person;</span><br><span class="line">+------------------------------------------+----------------------+------------------------------------------+------------+</span><br><span class="line">|                IDCARDNUM                 |         NAME         |                   AGE                    |    SEX     |</span><br><span class="line">+------------------------------------------+----------------------+------------------------------------------+------------+</span><br><span class="line">| <span class="number">100</span>                                      | &#x5C0F;&#x660E;                   | <span class="number">12</span>                                       | null       |</span><br><span class="line">| <span class="number">101</span>                                      | &#x5C0F;&#x7EA2;                   | <span class="number">15</span>                                       | null       |</span><br><span class="line">| <span class="number">103</span>                                      | &#x5C0F;&#x738B;                   | <span class="number">22</span>                                       | null       |</span><br><span class="line">+------------------------------------------+----------------------+------------------------------------------+------------+</span><br><span class="line"><span class="number">3</span> rows selected (<span class="number">0.113</span> seconds)</span><br></pre></td></tr></table></figure>
<p>&#x4E0A;&#x56FE;&#x770B;&#x5230;&#x5DF2;&#x7ECF;&#x65B0;&#x589E;&#x4E86;&#x5217;<code>sex</code>&#xFF0C;&#x6BCF;&#x884C;&#x7684;&#x9ED8;&#x8BA4;&#x503C;&#x4E3A; <code>null</code> &#xFF0C;&#x90A3;&#x4E48;&#x600E;&#x4E48;&#x6837;&#x4FEE;&#x6539;&#x8FD9;&#x4E9B;&#x503C;&#x5462;&#xFF1F;</p>
<p>4&#x3001; &#x66F4;&#x65B0;&#x8868;&#x6570;&#x636E; &#xFF0C;&#x6807;&#x51C6;&#x7684;sql &#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator"><span class="keyword">update</span> test.Person <span class="keyword">set</span> sex=<span class="string">&apos;&#x7537;&apos;</span> <span class="keyword">where</span> IDCardNum=<span class="number">100</span>;</span></span><br><span class="line"><span class="operator"><span class="keyword">update</span> test.Person <span class="keyword">set</span> sex=<span class="string">&apos;&#x5973;&apos;</span> <span class="keyword">where</span> IDCardNum=<span class="number">101</span>;</span></span><br><span class="line"><span class="operator"><span class="keyword">update</span> test.Person <span class="keyword">set</span> sex=<span class="string">&apos;&#x7537;&apos;</span> <span class="keyword">where</span> IDCardNum=<span class="number">103</span>;</span></span><br></pre></td></tr></table></figure>
<p>Phoenix&#x4E2D;&#x4E0D;&#x5B58;&#x5728;<code>update</code>&#x7684;&#x8BED;&#x6CD5;&#x5173;&#x952E;&#x5B57;&#xFF0C;&#x800C;&#x662F;<code>upsert</code> &#xFF0C;&#x529F;&#x80FD;&#x4E0A;&#x66FF;&#x4EE3;&#x4E86;<code>Insert+update</code>&#xFF0C;&#x5B98;&#x65B9;&#x8BF4;&#x660E;&#x4E3A;&#xFF1A;</p>
<blockquote>
<p><strong>UPSERT VALUES</strong><br>Inserts if not present and updates otherwise the value in the table. The list of columns is optional and if not present, the values will map to the column in the order they are declared in the schema. The values must evaluate to constants.</p>
</blockquote>
<p>&#x6839;&#x636E;&#x4ECB;&#x7ECD;&#xFF0C;&#x53EA;&#x9700;&#x8981;&#x5728;<code>upsert</code>&#x8BED;&#x53E5;&#x4E2D;&#x5236;&#x5B9A;&#x5B58;&#x5728;&#x7684;<code>idcardnum</code>&#x5373;&#x53EF;&#x5B9E;&#x73B0;&#x66F4;&#x65B0;&#xFF0C;&#x5728; Phoenix &#x5BA2;&#x6237;&#x7AEF;&#x4E2D;&#x64CD;&#x4F5C;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span>: jdbc:phoenix:<span class="number">10.35</span>.<span class="number">66.72</span>&gt; upsert into test.person (idcardnum,sex) values (<span class="number">100</span>,<span class="string">&apos;&#x7537;&apos;</span>);</span><br><span class="line"><span class="number">1</span> row affected (<span class="number">0.083</span> seconds)</span><br><span class="line"><span class="number">0</span>: jdbc:phoenix:<span class="number">10.35</span>.<span class="number">66.72</span>&gt; upsert into test.person (idcardnum,sex) values (<span class="number">101</span>,<span class="string">&apos;&#x5973;&apos;</span>);</span><br><span class="line"><span class="number">1</span> row affected (<span class="number">0.012</span> seconds)</span><br><span class="line"><span class="number">0</span>: jdbc:phoenix:<span class="number">10.35</span>.<span class="number">66.72</span>&gt; upsert into test.person (idcardnum,sex) values (<span class="number">103</span>,<span class="string">&apos;&#x7537;&apos;</span>);</span><br><span class="line"><span class="number">1</span> row affected (<span class="number">0.008</span> seconds)</span><br><span class="line"><span class="number">0</span>: jdbc:phoenix:<span class="number">10.35</span>.<span class="number">66.72</span>&gt; select * from test.person;</span><br><span class="line">+------------------------------------------+----------------------+------------------------------------------+------------+</span><br><span class="line">|                IDCARDNUM                 |         NAME         |                   AGE                    |    SEX     |</span><br><span class="line">+------------------------------------------+----------------------+------------------------------------------+------------+</span><br><span class="line">| <span class="number">100</span>                                      | &#x5C0F;&#x660E;                   | <span class="number">12</span>                                       | &#x7537;          |</span><br><span class="line">| <span class="number">101</span>                                      | &#x5C0F;&#x7EA2;                   | <span class="number">15</span>                                       | &#x5973;          |</span><br><span class="line">| <span class="number">103</span>                                      | &#x5C0F;&#x738B;                   | <span class="number">22</span>                                       | &#x7537;          |</span><br><span class="line">+------------------------------------------+----------------------+------------------------------------------+------------+</span><br><span class="line"><span class="number">3</span> rows selected (<span class="number">0.087</span> seconds)</span><br></pre></td></tr></table></figure>
<p>5&#x3001;&#x590D;&#x6742;&#x67E5;&#x8BE2;&#xFF0C;&#x901A;&#x8FC7;Phoenix&#x53EF;&#x4EE5;&#x652F;&#x6301; where&#x3001;group by&#x3001;case when &#x7B49;&#x590D;&#x6742;&#x7684;&#x67E5;&#x8BE2;&#x6761;&#x4EF6;&#xFF0C;&#x6848;&#x4F8B;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># &#x73B0;&#x589E;&#x52A0;&#x51E0;&#x6761;&#x6570;&#x636E;</span></span><br><span class="line"><span class="number">0</span>: jdbc:phoenix:<span class="number">10.35</span>.<span class="number">66.72</span>&gt; upsert into test.Person (IDCardNum,Name,Age,sex) values (<span class="number">104</span>,<span class="string">&apos;&#x5C0F;&#x5F20;&apos;</span>,<span class="number">23</span>,<span class="string">&apos;&#x7537;&apos;</span>);</span><br><span class="line"><span class="number">1</span> row affected (<span class="number">0.012</span> seconds)</span><br><span class="line"><span class="number">0</span>: jdbc:phoenix:<span class="number">10.35</span>.<span class="number">66.72</span>&gt; upsert into test.Person (IDCardNum,Name,Age,sex) values (<span class="number">105</span>,<span class="string">&apos;&#x5C0F;&#x674E;&apos;</span>,<span class="number">28</span>,<span class="string">&apos;&#x7537;&apos;</span>);</span><br><span class="line"><span class="number">1</span> row affected (<span class="number">0.015</span> seconds)</span><br><span class="line"><span class="number">0</span>: jdbc:phoenix:<span class="number">10.35</span>.<span class="number">66.72</span>&gt; upsert into test.Person (IDCardNum,Name,Age,sex) values (<span class="number">106</span>,<span class="string">&apos;&#x5C0F;&#x674E;&apos;</span>,<span class="number">33</span>,<span class="string">&apos;&#x7537;&apos;</span>);</span><br><span class="line"><span class="number">1</span> row affected (<span class="number">0.011</span> seconds)</span><br><span class="line"><span class="number">0</span>: jdbc:phoenix:<span class="number">10.35</span>.<span class="number">66.72</span>&gt; select * from test.person;</span><br><span class="line">+------------------------------------------+----------------------+------------------------------------------+------------+</span><br><span class="line">|                IDCARDNUM                 |         NAME         |                   AGE                    |    SEX     |</span><br><span class="line">+------------------------------------------+----------------------+------------------------------------------+------------+</span><br><span class="line">| <span class="number">100</span>                                      | &#x5C0F;&#x660E;                   | <span class="number">12</span>                                       | &#x7537;          |</span><br><span class="line">| <span class="number">101</span>                                      | &#x5C0F;&#x7EA2;                   | <span class="number">15</span>                                       | &#x5973;          |</span><br><span class="line">| <span class="number">103</span>                                      | &#x5C0F;&#x738B;                   | <span class="number">22</span>                                       | &#x7537;          |</span><br><span class="line">| <span class="number">104</span>                                      | &#x5C0F;&#x5F20;                   | <span class="number">23</span>                                       | &#x7537;          |</span><br><span class="line">| <span class="number">105</span>                                      | &#x5C0F;&#x674E;                   | <span class="number">28</span>                                       | &#x7537;          |</span><br><span class="line">| <span class="number">106</span>                                      | &#x5C0F;&#x674E;                   | <span class="number">33</span>                                       | &#x7537;          |</span><br><span class="line">+------------------------------------------+----------------------+------------------------------------------+------------+</span><br><span class="line"><span class="number">6</span> rows selected (<span class="number">0.09</span> seconds)</span><br></pre></td></tr></table></figure>
<p>where + group by &#x8BED;&#x53E5;&#x4F8B;&#x5B50;&#xFF1A;</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">jdbc:phoenix:<span class="number">10.35</span>.<span class="number">66.72</span>&gt; select sex ,count(sex) as num from test.person <span class="built_in">where</span> age &gt;<span class="number">20</span> group by sex;</span><br><span class="line">+------------+------------------------------------------+</span><br><span class="line">|    SEX     |                   NUM                    |</span><br><span class="line">+------------+------------------------------------------+</span><br><span class="line">| &#x7537;          | <span class="number">4</span>                                        |</span><br><span class="line">+------------+------------------------------------------+</span><br></pre></td></tr></table></figure>
<p>case when &#x7684;&#x4F8B;&#x5B50;&#xFF1A;</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span>: jdbc:phoenix:<span class="number">10.35</span>.<span class="number">66.72</span>&gt; select (<span class="keyword">case</span> name when <span class="string">&apos;&#x5C0F;&#x660E;&apos;</span> <span class="keyword">then</span> <span class="string">&apos;&#x660E;&#x660E;&#x554A;&apos;</span> when <span class="string">&apos;&#x5C0F;&#x7EA2;&apos;</span> <span class="keyword">then</span> <span class="string">&apos;&#x7EA2;&#x7EA2;&#x554A;&apos;</span> <span class="keyword">else</span> name end) as showname from test.person;</span><br><span class="line">+------------------------------------------+</span><br><span class="line">|                 SHOWNAME                 |</span><br><span class="line">+------------------------------------------+</span><br><span class="line">| &#x660E;&#x660E;&#x554A;                                      |</span><br><span class="line">| &#x7EA2;&#x7EA2;&#x554A;                                      |</span><br><span class="line">| &#x5C0F;&#x738B;                                       |</span><br><span class="line">| &#x5C0F;&#x5F20;                                       |</span><br><span class="line">| &#x5C0F;&#x674E;                                       |</span><br><span class="line">| &#x5C0F;&#x674E;                                       |</span><br><span class="line">+------------------------------------------+</span><br></pre></td></tr></table></figure>
<p>&#x66F4;&#x591A;&#x652F;&#x6301;&#x8BED;&#x6CD5;&#x53C2;&#x8003;&#xFF1A;<a href="https://phoenix.apache.org/language/index.html" target="_blank" rel="external">https://phoenix.apache.org/language/index.html</a></p>
<p>6&#x3001;&#x5220;&#x9664;&#x6570;&#x636E;&#x53CA;&#x5220;&#x9664;&#x8868;&#xFF0C;&#x6807;&#x51C6;sql&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator"><span class="keyword">delete</span> <span class="keyword">from</span> test.Person <span class="keyword">where</span> idcardnum=<span class="number">100</span>;</span></span><br><span class="line"><span class="operator"><span class="keyword">drop</span> <span class="keyword">table</span> test.person;</span></span><br></pre></td></tr></table></figure>
<p>Phoenix&#x4E2D;&#x540C;&#x6807;&#x51C6;sql&#x4E00;&#x6837;&#xFF0C;&#x6848;&#x4F8B;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span>: jdbc:phoenix:<span class="number">10.35</span>.<span class="number">66.72</span>&gt; delete from test.Person <span class="built_in">where</span> idcardnum=<span class="number">100</span>;</span><br><span class="line"><span class="number">1</span> row affected (<span class="number">0.072</span> seconds)</span><br><span class="line"><span class="number">0</span>: jdbc:phoenix:<span class="number">10.35</span>.<span class="number">66.72</span>&gt; select * from test.Person <span class="built_in">where</span> idcardnum=<span class="number">100</span>;</span><br><span class="line">+------------------------------------------+----------------------+------------------------------------------+------------+</span><br><span class="line">|                IDCARDNUM                 |         NAME         |                   AGE                    |    SEX     |</span><br><span class="line">+------------------------------------------+----------------------+------------------------------------------+------------+</span><br><span class="line">+------------------------------------------+----------------------+------------------------------------------+------------+</span><br><span class="line"></span><br><span class="line"><span class="number">0</span>: jdbc:phoenix:<span class="number">10.35</span>.<span class="number">66.72</span>&gt; drop table test.person;</span><br><span class="line">No rows affected (<span class="number">1.799</span> seconds)</span><br><span class="line"><span class="number">0</span>: jdbc:phoenix:<span class="number">10.35</span>.<span class="number">66.72</span>&gt; select * from test.person;</span><br><span class="line">Error: ERROR <span class="number">1012</span> (<span class="number">42</span>M03): Table undefined. tableName=TEST.PERSON (state=<span class="number">42</span>M03,code=<span class="number">1012</span>)</span><br><span class="line"><span class="number">0</span>: jdbc:phoenix:<span class="number">10.35</span>.<span class="number">66.72</span>&gt; !tables</span><br><span class="line">+------------------------------------------+------------------------------------------+------------------------------------------+-------------------+</span><br><span class="line">|                TABLE_CAT                 |               TABLE_SCHEM                |                TABLE_NAME                |                TA |</span><br><span class="line">+------------------------------------------+------------------------------------------+------------------------------------------+-------------------+</span><br><span class="line">| null                                     | WL                                       | BIG_LOG_DEVUTRACEID_INDEX                | INDEX             |</span><br><span class="line">| null                                     | WL                                       | MSGCENTER_PUSHMESSAGE_V2_OWNERPAGE_INDEX | INDEX             |</span><br><span class="line">| null                                     | SYSTEM                                   | CATALOG                                  | SYSTEM TABLE      |</span><br><span class="line">| null                                     | SYSTEM                                   | SEQUENCE                                 | SYSTEM TABLE      |</span><br><span class="line">| null                                     | SYSTEM                                   | STATS                                    | SYSTEM TABLE      |</span><br><span class="line">| null                                     | DMO                                      | SOWNTOWN_STATICS                         | TABLE             |</span><br><span class="line">| null                                     | OL                                       | BIGLOG                                   | TABLE             |</span><br><span class="line">| null                                     | WL                                       | BIG_LOG                                  | TABLE             |</span><br><span class="line">| null                                     | WL                                       | ERROR_LOG                                | TABLE             |</span><br><span class="line">| null                                     | WL                                       | MSGCENTER_PUSHMESSAGE                    | TABLE             |</span><br><span class="line">| null                                     | WL                                       | MSGCENTER_PUSHMESSAGE_V2                 | TABLE             |</span><br><span class="line">+------------------------------------------+------------------------------------------+------------------------------------------+-------------------+</span><br></pre></td></tr></table></figure>
<h1 id="&#x4E09;&#x56FE;&#x5F62;&#x5316;&#x5BA2;&#x6237;&#x7AEF;squirrel&#x4F7F;&#x7528;">&#x4E09;&#x3001;&#x56FE;&#x5F62;&#x5316;&#x5BA2;&#x6237;&#x7AEF;SQuirrel&#x4F7F;&#x7528;</h1><p>&#x5982;&#x679C;&#x4F60;&#x4E0D;&#x559C;&#x6B22; &#x7EC8;&#x7AEF;&#x4E0B;&#x7684;&#x811A;&#x672C;&#x547D;&#x4EE4;&#xFF0C;&#x9752;&#x7750;&#x4E8E;GUI&#x5316;&#x7684;&#x5BA2;&#x6237;&#x7AEF;&#xFF0C;&#x90A3;&#x4E48; SQuirrel&#x662F;&#x4E2A;&#x597D;&#x7684;&#x9009;&#x62E9;&#xFF0C;&#x5C31;&#x8DDF;&#x5E73;&#x65E5;&#x91CC;&#x4F7F;&#x7528; MsSqlServer client&#x3001;Navicat client &#x4E00;&#x6837;&#xFF0C;&#x6548;&#x679C;&#x5982;&#x4E0B;&#x56FE;&#xFF1A;</p>
<p><img src="https://phoenix.apache.org/images/squirrel.png" alt="squirrel client"></p>
<p>&#x4F7F;&#x7528;&#x65B9;&#x6CD5;&#xFF1A;&#xFF08;&#x53EF;&#x4EE5;&#x53C2;&#x7167;<a href="https://phoenix.apache.org/installation.html#SQL_Client" target="_blank" rel="external">&#x5B98;&#x7F51;&#x82F1;&#x6587;&#x8BF4;&#x660E;</a>&#xFF09;</p>
<ol>
<li>&#x4E0B;&#x8F7D;SQuirrel &#x5BA2;&#x6237;&#x7AEF; &#xFF0C;&#x5730;&#x5740; <a href="http://squirrel-sql.sourceforge.net/" target="_blank" rel="external">http://squirrel-sql.sourceforge.net/</a></li>
<li>&#x89E3;&#x538B;&#x7F29;&#xFF0C;&#x5220;&#x9664; <code>lib/</code> &#x4E0B;&#x8001;&#x7248;&#x672C;&#x7684; <code>phoenix-[oldversion]-client.jar</code>&#x6587;&#x4EF6;&#xFF0C;&#x5C06;&#x4F60;&#x521A;&#x521A;&#x4E0B;&#x8F7D;&#x7684;Phoenix&#x6587;&#x4EF6;&#x5939;&#x4E0B;&#x6700;&#x65B0;&#x7684;&#x6587;&#x4EF6; &#x62F7;&#x8D1D;&#x8FC7;&#x53BB;&#xFF1B;</li>
<li>&#x542F;&#x52A8;SQuirrel&#x5BA2;&#x6237;&#x7AEF;&#xFF0C;&#x9009;&#x62E9; Drivers-new driver &#xFF0C;&#x540D;&#x79F0;&#x968F;&#x4FBF;&#xFF0C;url&#x683C;&#x5F0F;&#xFF1A; <code>jdbc:phoenix:&#xFF08;zk&#x5730;&#x5740;&#xFF09;</code> &#xFF0C;class name textbox &#x586B;&#x5199;<code>org.apache.phoenix.jdbc.PhoenixDriver</code> </li>
<li>ok&#xFF0C; &#x70B9;&#x51FB; connect&#x5373;&#x53EF;&#x5B8C;&#x6210;&#x8FDE;&#x63A5; </li>
</ol>
<p>squirrel &#x5BA2;&#x6237;&#x7AEF;&#x7684;&#x7528;&#x6CD5; &#x548C; Phoenix &#x81EA;&#x5E26;&#x7EC8;&#x7AEF;&#x4E00;&#x6837;&#xFF0C;&#x90FD;&#x662F;&#x5E38;&#x89C1;&#x7684;sql&#x8BED;&#x53E5;&#xFF0C;&#x5927;&#x5BB6;&#x53EF;&#x4EE5;&#x81EA;&#x5DF1;&#x642D;&#x5EFA;&#x7EC3;&#x4E60;&#x3002;</p>
<h1 id="&#x56DB;-java-client-api-&#x4F7F;&#x7528;">&#x56DB;&#x3001; java client api &#x4F7F;&#x7528;</h1><p>java api &#x5B8C;&#x5168;&#x53EF;&#x4EE5;&#x91C7;&#x7528;&#x4F20;&#x7EDF;&#x7684; jdbc &#x8FDE;&#x63A5;&#x7684;&#x5F62;&#x5F0F;&#xFF0C;&#x6848;&#x4F8B;&#x5982;&#x5B98;&#x65B9;&#x63D0;&#x4F9B;&#xFF1A;</p>
<p>&#x521B;&#x5EFA;<code>test.java</code> &#x7C7B;&#xFF0C;&#x5185;&#x5BB9;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.DriverManager;</span><br><span class="line"><span class="keyword">import</span> java.sql.ResultSet;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"><span class="keyword">import</span> java.sql.PreparedStatement;</span><br><span class="line"><span class="keyword">import</span> java.sql.Statement;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">test</span> </span>{</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> SQLException </span>{</span><br><span class="line">		Statement stmt = <span class="keyword">null</span>;</span><br><span class="line">		ResultSet rset = <span class="keyword">null</span>;</span><br><span class="line">		</span><br><span class="line">		Connection con = DriverManager.getConnection(<span class="string">&quot;jdbc:phoenix:[zookeeper]&quot;</span>);</span><br><span class="line">		stmt = con.createStatement();</span><br><span class="line">		</span><br><span class="line">		stmt.executeUpdate(<span class="string">&quot;create table test (mykey integer not null primary key, mycolumn varchar)&quot;</span>);</span><br><span class="line">		stmt.executeUpdate(<span class="string">&quot;upsert into test values (1,&apos;Hello&apos;)&quot;</span>);</span><br><span class="line">		stmt.executeUpdate(<span class="string">&quot;upsert into test values (2,&apos;World!&apos;)&quot;</span>);</span><br><span class="line">		con.commit();</span><br><span class="line">		</span><br><span class="line">		PreparedStatement statement = con.prepareStatement(<span class="string">&quot;select * from test&quot;</span>);</span><br><span class="line">		rset = statement.executeQuery();</span><br><span class="line">		<span class="keyword">while</span> (rset.next()) {</span><br><span class="line">			System.out.println(rset.getString(<span class="string">&quot;mycolumn&quot;</span>));</span><br><span class="line">		}</span><br><span class="line">		statement.close();</span><br><span class="line">		con.close();</span><br><span class="line">	}</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>&#x5728;&#x7EC8;&#x7AEF;&#x4F7F;&#x7528;<code>javac</code>&#x7F16;&#x8BD1;&#xFF0C;&#x901A;&#x8FC7;Phoenix&#x5BA2;&#x6237;&#x7AEF;&#x6267;&#x884C;&#xFF0C;&#x5C31;&#x80FD;&#x770B;&#x5230;&#x7ED3;&#x679C;&#xFF1A;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ javac test.java</span><br><span class="line">$ java -cp <span class="string">&quot;../phoenix-[version]-client.jar:.&quot;</span> <span class="built_in">test</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># You should get the following output</span></span><br><span class="line">Hello World!</span><br></pre></td></tr></table></figure></p>
<p>&#x5F53;&#x7136;&#xFF0C;&#x5728;&#x751F;&#x4EA7;&#x4F7F;&#x7528;&#x4E2D;&#xFF0C;&#x5F80;&#x5F80;&#x91C7;&#x7528;&#x7684;&#x662F; <code>spring mvc + mybaits</code> &#x7684;&#x6846;&#x67B6;&#x6765;&#x8FDB;&#x884C;&#x8BBF;&#x95EE;&#x7684;&#xFF0C;Phoenix &#x5B8C;&#x5168;&#x652F;&#x6301;&#x8FD9;&#x79CD;&#x5F62;&#x5F0F;&#xFF0C;&#x5C31;&#x50CF;&#x5E73;&#x5E38;&#x5199;mysql&#x3001;SqlServer&#x4E00;&#x6837;&#xFF0C;&#x5BF9;&#x5E94;&#x7684;<code>jdbc.properties</code>&#x4E2D;&#x7684;&#x9A71;&#x52A8;&#x4FEE;&#x6539;&#x4E3A; <code>org.apache.phoenix.jdbc.PhoenixDriver</code> &#x5373;&#x53EF;&#xFF0C;&#x5176;&#x5B83;&#x7684;&#x5199;&#x6CD5;&#x901A;&#x666E;&#x901A;&#x7684;&#x4E00;&#x6837;&#x3002;</p>

      
    </div>

    <div>
      
        
<div id="wechat_subscriber" style="display: block； padding: 10px 0; margin: 20px auto; width: 100%; text-align: center">
    <img id="wechat_subscriber_qcode" src="/images/GeekNotes.jpg" alt="xirong wechat" style="width: 200px; max-width: 100%;"/>
    <div>我在公众号与你分享更多内容</div>
</div>

      
    </div>

    <div>
      
        
  <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
    <div>坚持原创技术分享，您的支持将鼓励我继续创作！</div>
    <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
      <span>赏</span>
    </button>
    <div id="QR" style="display: none;">
      
        <div id="wechat" style="display: inline-block">
          <img id="wechat_qr" src="/images/wechat.png" alt="xirong WeChat Pay"/>
          <p>微信打赏</p>
        </div>
      
      
        <div id="alipay" style="display: inline-block">
          <img id="alipay_qr" src="/images/alipay.png" alt="xirong Alipay"/>
          <p>支付宝打赏</p>
        </div>
      
    </div>
  </div>


      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/hbase/" rel="tag">#hbase</a>
          
            <a href="/tags/phoenix/" rel="tag">#phoenix</a>
          
            <a href="/tags/中间件/" rel="tag">#中间件</a>
          
            <a href="/tags/大数据/" rel="tag">#大数据</a>
          
        </div>
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2015/06/20/materials-about-sql/" rel="next" title="sql语句基础复习及资料推荐">
                <i class="fa fa-chevron-left"></i> sql语句基础复习及资料推荐
              </a>
            
          </div>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2015/06/28/the-things-i-thought-of-kaifuli/" rel="prev" title="我所敬佩的开复老师">
                我所敬佩的开复老师 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
      <div class="ds-thread" data-thread-key="2015/06/24/how-hbase-use-apache-phoenix/"
           data-title="使用Phoenix通过sql语句更新操作hbase数据" data-url="http://www.ixirong.com/2015/06/24/how-hbase-use-apache-phoenix/">
      </div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/xirong.jpg"
               alt="xirong" />
          <p class="site-author-name" itemprop="name">xirong</p>
          <p class="site-description motion-element" itemprop="description">思考生活，分享故事</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">62</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              
                <span class="site-state-item-count">20</span>
                <span class="site-state-item-name">分类</span>
              
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">93</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="http://weixin.sogou.com/weixin?type=1&query=Geek_Notes&ie=utf8&w=01019900&sut=4856&sst0=1451527213494&lkt=1%2C1451527211738%2C1451527211738" target="_blank" title="wechat">
                  
                    <i class="fa fa-fw fa-weixin"></i>
                  
                  wechat
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/jackieliuxirong" target="_blank" title="weibo">
                  
                    <i class="fa fa-fw fa-weibo"></i>
                  
                  weibo
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://github.com/xirong/" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
          
        </div>

        
        

        
        
          <div class="links-of-blogroll motion-element links-of-blogroll-inline">
            <div class="links-of-blogroll-title">
              <i class="fa  fa-fw fa-globe"></i>
              推荐阅读
            </div>
            <ul class="links-of-blogroll-list">
              
                <li class="links-of-blogroll-item">
                  <a href="http://www.zhoujingen.cn/blog/" title="敏捷个人" target="_blank">敏捷个人</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://macshuo.com/" title="MacTalk" target="_blank">MacTalk</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://www.ruanyifeng.com/blog/" title="阮一峰" target="_blank">阮一峰</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://coolshell.cn/" title="酷壳" target="_blank">酷壳</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://www.read.org.cn/" title="战隼" target="_blank">战隼</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://www.mifengtd.cn/" title="褪墨" target="_blank">褪墨</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://mindhacks.cn/" title="刘未鹏" target="_blank">刘未鹏</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://ddimples.github.io/" title="程小黑" target="_blank">程小黑</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://blog.javachen.com/" title="JavaChen" target="_blank">JavaChen</a>
                </li>
              
            </ul>
          </div>
        

      </section>

      
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">
            
              
            
            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#一安装使用"><span class="nav-number">1.</span> <span class="nav-text">一、安装使用</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#二shell-命令"><span class="nav-number">2.</span> <span class="nav-text">二、shell 命令</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#三图形化客户端squirrel使用"><span class="nav-number">3.</span> <span class="nav-text">三、图形化客户端SQuirrel使用</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#四-java-client-api-使用"><span class="nav-number">4.</span> <span class="nav-text">四、 java client api 使用</span></a></li></ol></div>
            
          </div>
        </section>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2014 - 
  <span itemprop="copyrightYear">2016</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">xirong</span>
</div>

<div class="powered-by">
  Powered by <a class="theme-link" href="http://hexo.io">Hexo</a>
</div>

<div class="powered-by">
  <div style="float:left;margin-top:7px;margin-right:10px;">
  <script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cspan id='cnzz_stat_icon_1254711542'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s11.cnzz.com/z_stat.php%3Fid%3D1254711542%26show%3Dpic' type='text/javascript'%3E%3C/script%3E"));</script>
  </div>
   鲁ICP备15013969号
</div>

<div class="theme-info">
  Clone theme -
  <a class="theme-link" href="https://github.com/xirong/hexo-theme-next">
    NexT.Mist
  </a>
</div>

        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.1"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.0.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.0.1"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.1"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"xirong"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  
    
  





  
  
  

  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script>
  <script>AV.initialize("HfEUHBkxIxPKFFWsM8E29K81-gzGzoHsz", "j8gTHCF5cxmeGRbV0QIujeUw");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  
<script type="text/javascript" async src="//push.zhanzhang.baidu.com/push.js">
</script>


</body>
</html>
